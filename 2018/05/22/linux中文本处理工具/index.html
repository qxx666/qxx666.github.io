<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>linux中文本处理工具 | 浅萧荨_Live</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="linux中有一些非常好用的文本处理工具    工具名 用途     cat 把文本中所有内容显示到屏幕中（从首行到尾行）   more 显示文本内容，只能向后翻页   less 对文件或其它输出进行分页显示的工具   Header 查看前n行（不加n默认是10行）   cut 文本切割   tail 显示文件结尾内容   sort 文本排序（只是影响文本显示排序，并不改变文本原来的排序）（按as">
<meta property="og:type" content="article">
<meta property="og:title" content="linux中文本处理工具">
<meta property="og:url" content="http://yoursite.com/2018/05/22/linux中文本处理工具/index.html">
<meta property="og:site_name" content="浅萧荨_Live">
<meta property="og:description" content="linux中有一些非常好用的文本处理工具    工具名 用途     cat 把文本中所有内容显示到屏幕中（从首行到尾行）   more 显示文本内容，只能向后翻页   less 对文件或其它输出进行分页显示的工具   Header 查看前n行（不加n默认是10行）   cut 文本切割   tail 显示文件结尾内容   sort 文本排序（只是影响文本显示排序，并不改变文本原来的排序）（按as">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-06-20T06:53:13.753Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="linux中文本处理工具">
<meta name="twitter:description" content="linux中有一些非常好用的文本处理工具    工具名 用途     cat 把文本中所有内容显示到屏幕中（从首行到尾行）   more 显示文本内容，只能向后翻页   less 对文件或其它输出进行分页显示的工具   Header 查看前n行（不加n默认是10行）   cut 文本切割   tail 显示文件结尾内容   sort 文本排序（只是影响文本显示排序，并不改变文本原来的排序）（按as">
  
    <link rel="alternate" href="/atom.xml" title="浅萧荨_Live" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">浅萧荨_Live</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">welcome to my home</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-linux中文本处理工具" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/22/linux中文本处理工具/" class="article-date">
  <time datetime="2018-05-22T08:08:45.000Z" itemprop="datePublished">2018-05-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      linux中文本处理工具
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>linux中有一些非常好用的文本处理工具</p>
<table>
<thead>
<tr>
<th style="text-align:left">工具名</th>
<th style="text-align:left">用途</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">cat</td>
<td style="text-align:left">把文本中所有内容显示到屏幕中（从首行到尾行）</td>
</tr>
<tr>
<td style="text-align:left">more</td>
<td style="text-align:left">显示文本内容，只能向后翻页</td>
</tr>
<tr>
<td style="text-align:left">less</td>
<td style="text-align:left">对文件或其它输出进行分页显示的工具</td>
</tr>
<tr>
<td style="text-align:left">Header</td>
<td style="text-align:left">查看前n行（不加n默认是10行）</td>
</tr>
<tr>
<td style="text-align:left">cut</td>
<td style="text-align:left">文本切割</td>
</tr>
<tr>
<td style="text-align:left">tail</td>
<td style="text-align:left">显示文件结尾内容</td>
</tr>
<tr>
<td style="text-align:left">sort</td>
<td style="text-align:left">文本排序（只是影响文本显示排序，并不改变文本原来的排序）（按ascll表排序）</td>
</tr>
<tr>
<td style="text-align:left">uniq</td>
<td style="text-align:left">略过相邻重复的行</td>
</tr>
<tr>
<td style="text-align:left">wc</td>
<td style="text-align:left">显示文件数目</td>
</tr>
<tr>
<td style="text-align:left">grep</td>
<td style="text-align:left">文本过滤器</td>
</tr>
<tr>
<td style="text-align:left">sed</td>
<td style="text-align:left">流编辑器</td>
</tr>
<tr>
<td style="text-align:left">awk</td>
<td style="text-align:left">报告生成器，格式化以后，显示</td>
</tr>
</tbody>
</table>
<p>本章重点介绍grep，sed和awk这三大文本处理利器，其他的工具会做说明但不做详细介绍<br><a id="more"></a></p>
<p>在正式介绍这三大文本处理器之前，先简单介绍一下正则表达式</p>
<h4 id="正则表达"><a href="#正则表达" class="headerlink" title="正则表达"></a>正则表达</h4><h4 id="grep-文本过滤器"><a href="#grep-文本过滤器" class="headerlink" title="grep 文本过滤器"></a>grep 文本过滤器</h4><ul>
<li>grep 语法</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">grep [option] pattern file_name/input_string</span><br><span class="line">option：</span><br><span class="line">  -i 忽略匹配字符的大小写</span><br><span class="line">  --color 将匹配的字符以高亮颜色标记出来</span><br><span class="line">  -v 显示没有被匹配的行</span><br><span class="line">  -o 只显示被模式匹配到的字符串</span><br><span class="line">  -E 使用扩展正则表达式</span><br><span class="line">  -A 当某一行被grep匹配到，它下一行也会显示  grep -A 2 ‘cord id’ /proc/cpuinfo</span><br><span class="line">  -B  前面行也会显示</span><br><span class="line">  -C  前后行也会显示</span><br><span class="line">pattern:</span><br></pre></td></tr></table></figure>
<h4 id="sed-流编辑器"><a href="#sed-流编辑器" class="headerlink" title="sed 流编辑器"></a>sed 流编辑器</h4><ul>
<li>sed 语法</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">sed [option] &apos;AdressCommond&apos; file_name</span><br><span class="line">option:</span><br><span class="line">  -n 静默模式，不显示默认空间的行</span><br><span class="line">  -i 直接修改原文件</span><br><span class="line">  -e SCRIPF  -e SCRIPT 可以</span><br><span class="line">Adress:</span><br><span class="line">  1.StartLine,Endline  比如：1,100  $:最后一行</span><br><span class="line">  2./RegExp/ 例如：/^root/</span><br><span class="line">  3./pattern1/,/pattern2/  第一次被pattern1匹配的行开始，至第二次被pattern2匹配到的行.结束</span><br><span class="line">  4.LineNumber指定的行</span><br><span class="line">  5.StartLine，+N 从startLine开始，向后的N行</span><br><span class="line">Commond:</span><br><span class="line">d：删除符合条件的行；</span><br><span class="line">   p：显示符合条件的行</span><br><span class="line">   a\string ：在指定的行后面追加新行，内容为string</span><br><span class="line">        \n 可以用于换行</span><br><span class="line">   i\string 在指定的行前面</span><br><span class="line">   r FILE 将指定的文件的内容添加至符合条件的行处</span><br><span class="line">   w FILE 将地址指定范围内的行另存至指定的文件中</span><br><span class="line">   s/pattern/string/  修饰符：查找并替换，默认只替换每行中第一次被模式匹配到的字符串</span><br><span class="line">   加修饰符</span><br><span class="line">      g: 全局替换</span><br><span class="line">      i: 忽略字符大小写</span><br></pre></td></tr></table></figure>
<h4 id="awk-报告生成器，格式化以后，显示"><a href="#awk-报告生成器，格式化以后，显示" class="headerlink" title="awk 报告生成器，格式化以后，显示"></a>awk 报告生成器，格式化以后，显示</h4><ul>
<li>awk语法</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">awk [option] &apos;pattern&#123;action&#125;&apos; file1,file2....</span><br><span class="line">option:</span><br><span class="line"></span><br><span class="line">pattern</span><br><span class="line">  1、Regexp: 正则表达式，格式为/regular expression/</span><br><span class="line">  2、expresssion： 表达式，其值非0或为非空字符时满足条件，如：$1 ~ /foo/ 或 $1 == &quot;magedu&quot;，用运算符~(匹配)和!~(不匹配)。</span><br><span class="line">  3、Ranges： 指定的匹配范围，格式为pat1,pat2</span><br><span class="line">  4、BEGIN/END：特殊模式，仅在awk命令执行前运行一次或结束前运行一次</span><br><span class="line">  5、Empty(空模式)：匹配任意输入行；</span><br><span class="line">action:</span><br><span class="line">  1、Expressions:</span><br><span class="line">  2、Control statements</span><br><span class="line">  3、Compound statements</span><br><span class="line">  4、Input statements</span><br><span class="line">  5、Output statements</span><br></pre></td></tr></table></figure>
<p>对于action部分，awk是支持各种语句和函数的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">一、print</span><br><span class="line">print的使用格式：</span><br><span class="line">    print item1, item2, ...</span><br><span class="line">要点：</span><br><span class="line">1、各项目之间使用逗号隔开，而输出时则以空白字符分隔；</span><br><span class="line">2、输出的item可以为字符串或数值、当前记录的字段(如$1)、变量或awk的表达式；数值会先转换为字符串，而后再输出；</span><br><span class="line">3、print命令后面的item可以省略，此时其功能相当于print $0, 因此，如果想输出空白行，则需要使用print &quot;&quot;；</span><br><span class="line">例子：</span><br><span class="line"># awk &apos;BEGIN &#123; print &quot;line one\nline two\nline three&quot; &#125;&apos;</span><br><span class="line">awk -F: &apos;&#123; print $1, $3 &#125;&apos; /etc/passwd</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">二、awk变量</span><br><span class="line">2.1 awk内置变量之记录变量：</span><br><span class="line">FS: field separator，读取文件本时，所使用字段分隔符；</span><br><span class="line">RS: Record separator，输入文本信息所使用的换行符；</span><br><span class="line">OFS: Output Filed Separator:</span><br><span class="line">ORS：Output Row Separator：</span><br><span class="line">awk -F:</span><br><span class="line">OFS=&quot;#&quot;</span><br><span class="line">FS=&quot;:&quot;</span><br><span class="line">2.2 awk内置变量之数据变量：</span><br><span class="line">NR: The number of input records，awk命令所处理的记录数；如果有多个文件，这个数目会把处理的多个文件中行统一计数；</span><br><span class="line">NF：Number of Field，当前记录的field个数；</span><br><span class="line">FNR: 与NR不同的是，FNR用于记录正处理的行是当前这一文件中被总共处理的行数；</span><br><span class="line">ARGV: 数组，保存命令行本身这个字符串，如awk &apos;&#123;print $0&#125;&apos; a.txt b.txt这个命令中，ARGV[0]保存awk，ARGV[1]保存a.txt；</span><br><span class="line">ARGC: awk命令的参数的个数；</span><br><span class="line">FILENAME: awk命令所处理的文件的名称；</span><br><span class="line">ENVIRON：当前shell环境变量及其值的关联数组；</span><br><span class="line">如：awk &apos;BEGIN&#123;print ENVIRON[&quot;PATH&quot;]&#125;&apos;</span><br><span class="line">2.3 用户自定义变量</span><br><span class="line">gawk允许用户自定义自己的变量以便在程序代码中使用，变量名命名规则与大多数编程语言相同，只能使用字母、数字和下划线，且不能以数字开头。gawk变量名称区分字符大小写。</span><br><span class="line">2.3.1 在脚本中赋值变量</span><br><span class="line">在gawk中给变量赋值使用赋值语句进行，例如：</span><br><span class="line">awk &apos;BEGIN&#123;var=&quot;variable testing&quot;;print var&#125;&apos;</span><br><span class="line">2.3.2 在命令行中使用赋值变量</span><br><span class="line">gawk命令也可以在“脚本”外为变量赋值，并在脚本中进行引用。例如，上述的例子还可以改写为：</span><br><span class="line">awk -v var=&quot;variable testing&quot; &apos;BEGIN&#123;print var&#125;&apos;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">三、printf</span><br><span class="line">printf命令的使用格式：</span><br><span class="line">printf format, item1, item2, ...</span><br><span class="line">要点：</span><br><span class="line">1、其与print命令的最大不同是，printf需要指定format；</span><br><span class="line">2、format用于指定后面的每个item的输出格式；</span><br><span class="line">3、printf语句不会自动打印换行符；\n</span><br><span class="line">format格式的指示符都以%开头，后跟一个字符；如下：</span><br><span class="line">%c: 显示字符的ASCII码；</span><br><span class="line">%d, %i：十进制整数；</span><br><span class="line">%e, %E：科学计数法显示数值；</span><br><span class="line">%f: 显示浮点数；</span><br><span class="line">%g, %G: 以科学计数法的格式或浮点数的格式显示数值；</span><br><span class="line">%s: 显示字符串；</span><br><span class="line">%u: 无符号整数；</span><br><span class="line">%%: 显示%自身；</span><br><span class="line">修饰符：</span><br><span class="line">N: 显示宽度；</span><br><span class="line">-: 左对齐；</span><br><span class="line">+：显示数值符号；</span><br><span class="line">例子：</span><br><span class="line"># awk -F: &apos;&#123;printf &quot;%-15s %i\n&quot;,$1,$3&#125;&apos; /etc/passwd</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">四、输出重定向</span><br><span class="line">print items &gt; output-file</span><br><span class="line">print items &gt;&gt; output-file</span><br><span class="line">print items | command</span><br><span class="line">特殊文件描述符：</span><br><span class="line">/dev/stdin：标准输入</span><br><span class="line">/dev/sdtout: 标准输出</span><br><span class="line">/dev/stderr: 错误输出</span><br><span class="line">/dev/fd/N: 某特定文件描述符，如/dev/stdin就相当于/dev/fd/0；</span><br><span class="line">例子：</span><br><span class="line"># awk -F: &apos;&#123;printf &quot;%-15s %i\n&quot;,$1,$3 &gt; &quot;/dev/stderr&quot; &#125;&apos; /etc/passwd</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">五、awk的操作符：</span><br><span class="line">5.1 算术操作符：</span><br><span class="line">-x: 负值</span><br><span class="line">+x: 转换为数值；</span><br><span class="line">x^y:</span><br><span class="line">x**y: 次方</span><br><span class="line">x*y: 乘法</span><br><span class="line">x/y：除法</span><br><span class="line">x+y:</span><br><span class="line">x-y:</span><br><span class="line">x%y:</span><br><span class="line">5.2 字符串操作符：</span><br><span class="line">只有一个，而且不用写出来，用于实现字符串连接；</span><br><span class="line">5.3 赋值操作符：</span><br><span class="line">=</span><br><span class="line">+=</span><br><span class="line">-=</span><br><span class="line">*=</span><br><span class="line">/=</span><br><span class="line">%=</span><br><span class="line">^=</span><br><span class="line">**=</span><br><span class="line">++</span><br><span class="line">--</span><br><span class="line">需要注意的是，如果某模式为=号，此时使用/=/可能会有语法错误，应以/[=]/替代；</span><br><span class="line">5.4 布尔值</span><br><span class="line">awk中，任何非0值或非空字符串都为真，反之就为假；</span><br><span class="line">5.5 比较操作符：</span><br><span class="line">x &lt; y    True if x is less than y.</span><br><span class="line">x &lt;= y    True if x is less than or equal to y.</span><br><span class="line">x &gt; y    True if x is greater than y.</span><br><span class="line">x &gt;= y    True if x is greater than or equal to y.</span><br><span class="line">x == y    True if x is equal to y.</span><br><span class="line">x != y    True if x is not equal to y.</span><br><span class="line">x ~ y    True if the string x matches the regexp denoted by y.</span><br><span class="line">x !~ y    True if the string x does not match the regexp denoted by y.</span><br><span class="line">subscript in array      True if the array array has an element with the subscript subscript.</span><br><span class="line">5.6 表达式间的逻辑关系符：</span><br><span class="line">&amp;&amp;</span><br><span class="line">||</span><br><span class="line">5.7 条件表达式：</span><br><span class="line">selector?if-true-exp:if-false-exp</span><br><span class="line">if selector; then</span><br><span class="line">  if-true-exp</span><br><span class="line">else</span><br><span class="line">  if-false-exp</span><br><span class="line">fi</span><br><span class="line">a=3</span><br><span class="line">b=4</span><br><span class="line">a&gt;b?a is max:b ia max</span><br><span class="line">5.8 函数调用：</span><br><span class="line">function_name (para1,para2)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">六 awk的模式：</span><br><span class="line">awk &apos;program&apos; input-file1 input-file2 ...</span><br><span class="line">其中的program为:</span><br><span class="line">pattern &#123; action &#125;</span><br><span class="line">pattern &#123; action &#125;</span><br><span class="line">...</span><br><span class="line">6.1 常见的模式类型：</span><br><span class="line">1、Regexp: 正则表达式，格式为/regular expression/</span><br><span class="line">2、expresssion： 表达式，其值非0或为非空字符时满足条件，如：$1 ~ /foo/ 或 $1 == &quot;magedu&quot;，用运算符~(匹配)和!~(不匹配)。</span><br><span class="line">3、Ranges： 指定的匹配范围，格式为pat1,pat2</span><br><span class="line">4、BEGIN/END：特殊模式，仅在awk命令执行前运行一次或结束前运行一次</span><br><span class="line">5、Empty(空模式)：匹配任意输入行；</span><br><span class="line">7.2 常见的Action</span><br><span class="line">1、Expressions:</span><br><span class="line">2、Control statements</span><br><span class="line">3、Compound statements</span><br><span class="line">4、Input statements</span><br><span class="line">5、Output statements</span><br><span class="line">/正则表达式/：使用通配符的扩展集。</span><br><span class="line">关系表达式：可以用下面运算符表中的关系运算符进行操作，可以是字符串或数字的比较，如$2&gt;%1选择第二个字段比第一个字段长的行。</span><br><span class="line">模式匹配表达式：</span><br><span class="line">模式，模式：指定一个行的范围。该语法不能包括BEGIN和END模式。</span><br><span class="line">BEGIN：让用户指定在第一条输入记录被处理之前所发生的动作，通常可在这里设置全局变量。</span><br><span class="line">END：让用户在最后一条输入记录被读取之后发生的动作。</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">七 控制语句：</span><br><span class="line">7.1 if-else</span><br><span class="line">语法：if (condition) &#123;then-body&#125; else &#123;[ else-body ]&#125;</span><br><span class="line">例子：</span><br><span class="line">awk -F: &apos;&#123;if ($1==&quot;root&quot;) print $1, &quot;Admin&quot;; else print $1, &quot;Common User&quot;&#125;&apos; /etc/passwd</span><br><span class="line">awk -F: &apos;&#123;if ($1==&quot;root&quot;) printf &quot;%-15s: %s\n&quot;, $1,&quot;Admin&quot;; else printf &quot;%-15s: %s\n&quot;, $1, &quot;Common User&quot;&#125;&apos; /etc/passwd</span><br><span class="line">awk -F: -v sum=0 &apos;&#123;if ($3&gt;=500) sum++&#125;END&#123;print sum&#125;&apos; /etc/passwd</span><br><span class="line">7.2 while</span><br><span class="line">语法： while (condition)&#123;statement1; statment2; ...&#125;</span><br><span class="line">awk -F: &apos;&#123;i=1;while (i&lt;=3) &#123;print $i;i++&#125;&#125;&apos; /etc/passwd</span><br><span class="line">awk -F: &apos;&#123;i=1;while (i&lt;=NF) &#123; if (length($i)&gt;=4) &#123;print $i&#125;; i++ &#125;&#125;&apos; /etc/passwd</span><br><span class="line">7.3 do-while</span><br><span class="line">语法： do &#123;statement1, statement2, ...&#125; while (condition)</span><br><span class="line">awk -F: &apos;&#123;i=1;do &#123;print $i;i++&#125;while(i&lt;=3)&#125;&apos; /etc/passwd</span><br><span class="line">7.4 for</span><br><span class="line">语法： for ( variable assignment; condition; iteration process) &#123; statement1, statement2, ...&#125;</span><br><span class="line">awk -F: &apos;&#123;for(i=1;i&lt;=3;i++) print $i&#125;&apos; /etc/passwd</span><br><span class="line">awk -F: &apos;&#123;for(i=1;i&lt;=NF;i++) &#123; if (length($i)&gt;=4) &#123;print $i&#125;&#125;&#125;&apos; /etc/passwd</span><br><span class="line">for循环还可以用来遍历数组元素：</span><br><span class="line">语法： for (i in array) &#123;statement1, statement2, ...&#125;</span><br><span class="line">awk -F: &apos;$NF!~/^$/&#123;BASH[$NF]++&#125;END&#123;for(A in BASH)&#123;printf &quot;%15s:%i\n&quot;,A,BASH[A]&#125;&#125;&apos; /etc/passwd</span><br><span class="line">7.5 case</span><br><span class="line">语法：switch (expression) &#123; case VALUE or /REGEXP/: statement1, statement2,... default: statement1, ...&#125;</span><br><span class="line">7.6 break 和 continue</span><br><span class="line">常用于循环或case语句中</span><br><span class="line">7.7 next</span><br><span class="line">提前结束对本行文本的处理，并接着处理下一行；例如，下面的命令将显示其ID号为奇数的用户：</span><br><span class="line"># awk -F: &apos;&#123;if($3%2==0) next;print $1,$3&#125;&apos; /etc/passwd</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">八 awk中使用数组</span><br><span class="line">8.1 数组</span><br><span class="line">array[index-expression]</span><br><span class="line">index-expression可以使用任意字符串；需要注意的是，如果某数据组元素事先不存在，那么在引用其时，awk会自动创建此元素并初始化为空串；因此，要判断某数据组中是否存在某元素，需要使用index in array的方式。</span><br><span class="line">要遍历数组中的每一个元素，需要使用如下的特殊结构：</span><br><span class="line">for (var in array) &#123; statement1, ... &#125;</span><br><span class="line">其中，var用于引用数组下标，而不是元素值；</span><br><span class="line">例子：</span><br><span class="line">netstat -ant | awk &apos;/^tcp/ &#123;++S[$NF]&#125; END &#123;for(a in S) print a, S[a]&#125;&apos;</span><br><span class="line">每出现一被/^tcp/模式匹配到的行，数组S[$NF]就加1，NF为当前匹配到的行的最后一个字段，此处用其值做为数组S的元素索引；</span><br><span class="line">awk &apos;&#123;counts[$1]++&#125;; END &#123;for(url in counts) print counts[url], url&#125;&apos; /var/log/httpd/access_log</span><br><span class="line">用法与上一个例子相同，用于统计某日志文件中IP地的访问量</span><br><span class="line">8.2 删除数组变量</span><br><span class="line">从关系数组中删除数组索引需要使用delete命令。使用格式为：</span><br><span class="line">delete  array[index]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">九、awk的内置函数</span><br><span class="line">split(string, array [, fieldsep [, seps ] ])</span><br><span class="line">功能：将string表示的字符串以fieldsep为分隔符进行分隔，并将分隔后的结果保存至array为名的数组中；数组下标为从0开始的序列；</span><br><span class="line">netstat -ant | awk &apos;/:80\&gt;/&#123;split($5,clients,&quot;:&quot;);IP[clients[1]]++&#125;END&#123;for(i in IP)&#123;print IP[i],i&#125;&#125;&apos; | sort -rn | head -50</span><br><span class="line">length([string])</span><br><span class="line">功能：返回string字符串中字符的个数；</span><br><span class="line">substr(string, start [, length])</span><br><span class="line">功能：取string字符串中的子串，从start开始，取length个；start从1开始计数；</span><br><span class="line">system(command)</span><br><span class="line">功能：执行系统command并将结果返回至awk命令</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/22/linux中文本处理工具/" data-id="ck1d63kwj000f7outfe8qokyq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/05/24/docker中的网络/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          docker中的网络
        
      </div>
    </a>
  
  
    <a href="/2018/04/19/hadoop介绍/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">hadoop介绍</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">6</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/10/05/机器学习集锦/">机器学习集锦</a>
          </li>
        
          <li>
            <a href="/2019/08/30/微服务网关/">微服务网关</a>
          </li>
        
          <li>
            <a href="/2019/01/29/浅谈python/">浅谈python</a>
          </li>
        
          <li>
            <a href="/2018/11/08/python的一些模块/">python的一些模块</a>
          </li>
        
          <li>
            <a href="/2018/11/08/python数据类型/">python数据类型</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 浅萧荨<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>